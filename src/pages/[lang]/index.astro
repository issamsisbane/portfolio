---
import BaseLayout from "../../layouts/BaseLayout.astro";
import HorizontalCard from "../../components/HorizontalCard.astro";
import Education from "../../components/Education.astro";
import Certifications from "../../components/Certifications.astro";
import Experience from "../../components/Experience.astro";
import TechStack from "../../components/TechStack.astro";
import { getCollection } from "astro:content";
import createSlug from "../../lib/createSlug";

const { lang } = Astro.params;
const labels = await import(`../../i18n/locales/${lang}/index.${lang}.json`).then((m) => m.default);

const posts = (await getCollection("blog"))
  .filter((post) => post.data.lang === lang)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const last_posts = posts.slice(0, 3);

const projects = (await getCollection("projects"))
  .filter((project) => project.data.lang === lang)
  .filter((project) => project.data.selected === true)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const last_projects = projects.slice(0, 3);

export async function getStaticPaths() {
  return [{ params: { lang: "fr" } }, { params: { lang: "en" } }];
}
---

<BaseLayout sideBarActiveItemID="home" title={labels.metaTitle} lang={lang}>
  <div class="pb-12 mt-5">
    <div class="text-xl py-1">{labels.welcome} <p class="wave">ðŸ‘‹</p></div>
    <div class="text-5xl font-bold">{labels.name}</div>
    <div class="text-3xl py-3 font-bold">{labels.role}</div>
    <div class="py-2 text-lg">
      <p class="text-justify" set:html={labels.intro}></p>
    </div>
    
<div class="my-8 space-y-4">
  <div class="divider divider-start">
    <span class="text-xs font-bold text-center uppercase tracking-wider opacity-60">Quote of the day</span>
  </div>
  <div class="flex items-start gap-4">
    <svg class="w-8 h-8 text-primary flex-shrink-0 fill-[#99cbff] opacity-60" fill="currentColor" viewBox="0 0 24 24">
      <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
    </svg>
    <div class="flex-1">
      <blockquote class="text-lg italic opacity-90 mb-3">
        The best you can do is solve the problems of today based on what you learned yesterday. Keep learning and stay humble.
      </blockquote>
      <p class="text-sm font-medium opacity-70">â€” Kelsey Hightower</p>
      </br>
    </div>
  </div>
</div>

    <div class="mt-8">
      <a class="btn" href="mailto:issam.sisbane@gmail.com" target="_blank" title="issam.sisbane@gmail.com">
        {labels.contactButton}
      </a>
      <a href={labels.cvLink} target="_blank" class="btn btn-outline ml-5">
        {labels.cvButton}
      </a>
    </div>
  </div>

  <div>
    <div class="text-3xl w-full font-bold mb-2">
      {labels.techTitle} {"<ðŸ› >"}
    </div>
  </div>

  <br />
  <TechStack />
  <br />

<div>
    <div class="text-3xl w-full font-bold mb-5 mt-10">{labels.postsTitle} {"<ðŸ“>"}</div>
  </div>

  {last_posts.map((post, index) => (
    <>
      <HorizontalCard
        title={post.data.title}
        img={post.data.heroImage}
        desc={post.data.description}
        url={`/portfolio/${lang}/blog/` + createSlug(post.data.title, post.slug)}
        target="_self"
        date={post.data.pubDate}
        lang={lang}
        badge={post.data.badge}
      />
      {index !== last_projects.length - 1 && (
        <div class="divider my-0" />
      )}
    </>
  ))}

  <div class="flex justify-end">
    <a href={`/portfolio/${lang}/blog`}>
      <button class="btn btn-outline btn-sm">{labels.morePosts}</button>
    </a>
  </div>

<br />
<br />

  <div>
    <div class="text-3xl w-full font-bold mb-2">
      {labels.projectsTitle} {"<ðŸ—ï¸>"}
    </div>
  </div>

  {last_projects.map((project, index) => (
    <>
      <HorizontalCard
        title={project.data.title}
        img={project.data.heroImage}
        desc={project.data.description}
        url={`/portfolio/${lang}/projects/` + createSlug(project.data.title, project.slug)}
        target="_self"
        date={project.data.pubDate}
        lang={lang}
        badge={project.data.badge}
      />
      {index !== last_projects.length - 1 && (
        <div class="divider my-0" />
      )}
    </>
  ))}

  <div class="flex justify-end">
    <a href={`/portfolio/${lang}/projects`}>
      <button class="btn btn-outline btn-sm">{labels.moreProjects}</button>
    </a>
  </div>

  <br /><br />
  <Experience />
  <Education />
  <Certifications />

</BaseLayout>


